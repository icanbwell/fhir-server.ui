/* eslint-disable no-unused-vars */
/* eslint-disable no-trailing-spaces */
// This file is auto-generated by generate_components so do not edit manually

/**
{{ fhir_entity.fhir_name }}
{% for documentation_item in fhir_entity.documentation %}
    {{ documentation_item | wordwrap(78) | replace('\n', '\n    ') | replace('\r', '\n    ') }}
{% endfor %}
*/

{% if fhir_entity.cleaned_name == 'Person' %}
import React, { useContext } from 'react';
{% else %}
import React from 'react';
{% endif %}
import { Link } from 'react-router-dom';
{% if reverse_references.get(fhir_entity.cleaned_name) %}
import { Typography } from '@mui/material';
{% endif %}
import {{ '{ T' + fhir_entity.cleaned_name + ' }' }} from '../../types/resources/ {{- fhir_entity.cleaned_name -}}';

// Import all the partial resource
import Partials from '../../partials';
{% if fhir_entity.cleaned_name == 'Person' %}
import EnvironmentContext from '../../context/EnvironmentContext';
import UserContext from '../../context/UserContext';
{% endif %}
import { IdentifierSystem } from '../../utils/identifierSystem';

const {{ fhir_entity.cleaned_name }} = ({ resource }: { resource: {{ 'T' + fhir_entity.cleaned_name + ' ' -}}}): React.ReactElement => {
{% if fhir_entity.cleaned_name == 'Person' %}
    const { userDetails } = React.useContext(UserContext);
    const { fhirAdminUrl } = useContext(EnvironmentContext);
{% endif %}
    const tagUUID = resource?.meta?.tag?.find((s) => s.system === IdentifierSystem.uuid)?.code;
    const uuid = tagUUID ? tagUUID : resource.id;

{% if fhir_entity.cleaned_name == 'AuditEvent' %}
    const lastUpdated = resource?.meta?.lastUpdated;
    const queryString = `?date=ge${lastUpdated?.toString()}&date=le${lastUpdated?.toString()}`;
{% endif %}
    return (
        <>
        {% if fhir_entity.cleaned_name == 'AuditEvent' %}
            <Link title="Direct link to Resource" to={`/4_0_0/${resource.resourceType}/${uuid}${queryString}`}>
                {resource.resourceType}/{uuid}{queryString}
        {% else %}
            <Link title="Direct link to Resource" to={`/4_0_0/${resource.resourceType}/${uuid}`}>
                {resource.resourceType}/{uuid}
        {% endif %}
            </Link>
    {% for property in fhir_entity.properties %}
    {% if not property.is_v2_supported %}
        {% if property.is_code and 'Code' in available_partial_resources %}
            {
                resource.{{- property.javascript_clean_name }} &&
                <Partials.Code code={resource.{{- property.javascript_clean_name -}}} name='{{- generate_name(property.javascript_clean_name) -}}'/>
            }
        {% elif (get_component_name(property.cleaned_type) in available_partial_resources) %}
            {
                resource.{{- property.javascript_clean_name }} &&
                <Partials.{{ get_component_name(property.cleaned_type) }}
                    {{ property.type_snake_case }}={resource.{{- property.javascript_clean_name }}}
                    name='{{- generate_name(property.javascript_clean_name) -}}'
                    resourceType={resource.resourceType}
                    id={uuid}
                    searchParameter='{{- generate_search_parameter(property.javascript_clean_name) -}}'
                />
            }
        {% elif get_component_name(property.cleaned_type) in partials_mapping %}
            {
                resource.{{- property.javascript_clean_name }} &&
                <Partials.{{ partials_mapping[get_component_name(property.cleaned_type)]['partial'] }}
                    {{ partials_mapping[get_component_name(property.cleaned_type)]['prop_name'] }}={resource.{{- property.javascript_clean_name }}}
                    name='{{- generate_name(property.javascript_clean_name) -}}'
                    resourceType={resource.resourceType}
                    id={uuid}
                    searchParameter='{{- generate_search_parameter(property.javascript_clean_name) -}}'
                    field='{{- partials_mapping[get_component_name(property.cleaned_type)]['field'] -}}'
                />
            }
        {% elif fhir_entity.cleaned_name == "Organization" and property.javascript_clean_name == "name" %}
            {
                resource.name &&
                <Partials.NameValue
                    name='Name'
                    value={resource.name}
                    searchParameter='name'
                />
            }
        {% endif %}
    {% endif %}
    {%  endfor %}
    {% if reverse_references.get(fhir_entity.cleaned_name) %}
            <Typography variant="h4" sx={{- '{{ mt: 1 }}' -}}>
            {% if fhir_entity.cleaned_name == "Person" %}
                Resources Related to Linked Patient Resources
            {% else %}
                Related Resources
            {% endif %}
            </Typography>
        {% for reference in reverse_references.get(fhir_entity.cleaned_name) %}
            <Partials.ReverseReference
                name="{{- reference.get("name") -}}"
                id={uuid}
                resourceType={resource.resourceType}
                reverseReferences={{- '{' }}{{ reference.get("reverseReferences") }}{{ '}' }}
            />
        {% endfor %}
    {% endif %}
        {% if fhir_entity.cleaned_name == 'Person' %}
            <hr/>
            <div>
                <Typography variant="h5" sx={{- '{{ mt: 1 }}' -}}>Person Data Graph (in json)</Typography>
                <Link to={`/4_0_0/Person/${uuid}/$everything?contained=true&_format=json`}>
                    /4_0_0/Person/{uuid}/$everything?contained=true&_format=json
                </Link>
            </div>
            { userDetails?.isAdmin && (
                <>
                    <hr/>
                    <Typography variant="h4" sx={{- '{{ mt: 1 }}' -}}>Admin Functions</Typography>
                    <div>
                        <Typography variant="h5">Connected Person-Patient Graph</Typography>
                        <a href={`${fhirAdminUrl}/personPatientLink?bwellPersonId=${uuid}`}>
                            {fhirAdminUrl}/personPatientLink?bwellPersonId={uuid}
                        </a>
                    </div>
                    <div>
                        <Typography variant="h5" sx={{- '{{ mt: 1 }}' -}}>Delete all data</Typography>
                        <a href={`${fhirAdminUrl}/patientData?personId=${uuid}`}>
                            {fhirAdminUrl}/patientData?personId={uuid}
                        </a>
                    </div>
                </>
            )}
            <hr/>
        {% endif %}
        </>
    );
};

export default {{ fhir_entity.cleaned_name }};

